# Скрипт тестирования производительности вывода глубоких моделей с использованием Inference Engine в составе Intel® Distribution of OpenVINO™ toolkit

## Использование скрипта тестирования производительности

Скрипт запускается посредством вызова следующей командной строки:
```bash
python inference_benchmark.py \
    -f <results.csv> -c <benchmark_configuration.xml>
```

Параметры скрипта:
- `-f / --filename <results.csv>` - имя результирующего файла с форматом.
- `-с / --config <benchmark_configuration.xml>` - путь до файла конфигурации,
  содержащего информацию о проводимых тестах.

Примеры запуска:
```bash
python inference_benchmark.py \
    -f results.csv -c C:/benchmark_configuration.xml
python inference_benchmark.py \
    --filename results.csv --config C:/benchmark_configuration.xml
```

Примечание: если агрументы не переданы или переданы
некорректно, скрипт сообщит об ошибке и закончит свою работу.

## Работа скрипта тестирования производительности

Для каждой модели из списка производится тестирование в соответствии
c приведенными в конфигурации параметрами.

## Результаты работы скрипта тестирования производительности

Скрипт выполняет тестирование производительности моделей,
после чего создает результирующий файл (csv-таблица)
и сохраняет в него данные о выполненных тестах и полученных показателях
производительности.

## Показатели производительности

**Синхронный и асинхронный режимы вывода**

Intel® Distribution of OpenVINO™ toolkit предусматривает два режима вывода
глубоких нейросетевых моделей.
1. **Синхронный режим.** Предполагает создание и запуск одного запроса
на вывод модели на выбранном устройстве. Каждый следующий запрос
на вывод создается по завершении предыдущего. При реализации
количество создаваемых запросов определяется числом итераций цикла
тестирования модели.
2. **Асинхронный режим.** Предусматривает возможность создания набора
запросов на вывод на выбранном устройстве. Порядок завершения запросов
в простейшем случае соответствует последовательности их создания,
а для некоторых задач - определяется структурой модели и сложностью
входных данных. Количество создаваемых наборов определяется числом
итераций цикла тестирования модели.

Следует отметить, что один запрос на вывод предполагает прямой проход
нейронной сети для "пачки" изображений. Размер "пачки" в запросе,
количество итераций цикла тестирования, количество создаваемых запросов
в асинхронном режиме являются параметрами вывода.


**Показатели производительности для синхронного режима**

При оценке производительности вывода для синхронного режима
осуществляется последовательный и независимый запуск запросов.
Запуск очередного запроса выполняется после завершения предыдущего.
Для каждого запроса осуществляется замер времени его выполнения.
Для множества полученных времен определяется стандартное среднеквадратичное
отклонение, и отбрасываются времена, выходящие за пределы трех стандартных
отклонений от среднего времени вывода. Результирующий набор времен
используется для вычисления показателя латентности. Остальные показатели
вычисляются для всего множества времен.
- **Латентность (latency)** - медиана множества времен выполнения вывода.
- **Среднее время одного прохода (average time of single pass)** - отношение
  общего времени выполнения всех запросов к числу запросов.
- **Количество кадров, обрабатываемых за секунду (frames per second, FPS)** -
  отношение размера обрабатываемой “пачки” изображений к среднему времени
  одного прохода.

**Показатели производительности для асинхронного режима**

- **Среднее время одного прохода (average time of single pass)** -
  отношение времени выполнения всех наборов запросов к числу
  итераций цикла тестирования. Характеризует время выполнения набора
  одновременно созданных запросов на устройстве.
- **Количество кадров, обрабатываемых за секунду (frames per second, FPS)** -
  отношение произведения размера обрабатываемой "пачки" и числа итераций
  к общему времени выполнения всех запросов.